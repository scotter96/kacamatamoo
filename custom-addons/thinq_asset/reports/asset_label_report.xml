<odoo>
    <data>
        <!-- Custom Grid Templates -->
        <template id="report_asset_label_custom_107">
            <t t-call="web.basic_layout">
                <!-- Ambil qty dari context -->
                <t t-set="qty" t-value="int(context.get('custom_quantity', 1))"/>
                <t t-set="total_labels" t-value="qty * len(docs)"/>
                <t t-set="labels_per_page" t-value="40"/>  <!-- 5 x 8 = 40 -->
                <t t-set="total_pages" t-value="int((total_labels - 1) / labels_per_page) + 1 if total_labels > 0 else 1"/>
                
                <!-- Loop untuk setiap halaman -->
                <t t-foreach="range(total_pages)" t-as="page_num">
                    <div class="page">
                        <!-- Container utama dengan table layout untuk grid 5x8 (18x50mm per label) -->
                        <table style="width:250mm; height:144mm; margin:0; padding:0; border-collapse:collapse; table-layout:fixed; border:none;">
                            <!-- Hitung label untuk halaman ini -->
                            <t t-set="start_label" t-value="page_num * labels_per_page"/>
                            <t t-set="end_label" t-value="min((page_num + 1) * labels_per_page, total_labels)"/>
                            
                            <!-- Loop untuk 8 baris -->
                            <t t-foreach="range(8)" t-as="row">
                                <tr style="height:18mm; border:none;">
                                    <!-- Loop untuk 5 kolom -->
                                    <t t-foreach="range(5)" t-as="col">
                                        <t t-set="current_label" t-value="start_label + (row * 5 + col)"/>
                                        
                                        <td style="width:50mm; height:18mm; padding:0; margin:0; border:none; vertical-align:middle;">
                                            <!-- Jika masih ada label yang perlu dicetak di halaman ini -->
                                            <t t-if="current_label &lt; end_label">
                                                <!-- Tentukan asset untuk label ini -->
                                                <t t-set="asset_index" t-value="int(current_label / qty)"/>
                                                <t t-set="current_asset" t-value="docs[asset_index]"/>
                                                
                                                <div style="width:100%; height:100%; display:flex; flex-direction:column; justify-content:space-between; font-family:Arial, sans-serif; font-size:8px; padding:1mm; box-sizing:border-box;">
                                                    <!-- Company Name di atas -->
                                                    <div style="width:100%; text-align:center; flex-shrink:0; margin-bottom:1.5mm;">
                                                        <div style="font-weight:bold; font-size:8px; line-height:1;">
                                                            <t t-esc="current_asset.company_id.name"/>
                                                        </div>
                                                    </div>

                                                    <!-- Barcode di tengah -->
                                                    <div style="width:100%; text-align:center; flex-grow:1; display:flex; align-items:center; justify-content:center;">
                                                        <t t-set="barcode_value" t-value="current_asset.asset_code"/>
                                                        <t t-if="barcode_value">
                                                            <div t-out="barcode_value" t-options="{
                                                                'widget': 'barcode',
                                                                'symbology': 'Code128',
                                                                'width': 160, 
                                                                'height': 35, 
                                                                'quiet': 0,
                                                                'style': 'max-width:46mm; height:6mm; margin: 0 auto;'
                                                            }"/>
                                                        </t>
                                                    </div>

                                                    <!-- Asset Name & Code di bawah -->
                                                    <div style="width:100%; text-align:center; flex-shrink:0; margin-top:1mm;">
                                                        <div style="font-size:6px; font-weight:normal; line-height:1; word-wrap:break-word; overflow:hidden;">
                                                            <span t-esc="current_asset.name"/> - <strong t-esc="current_asset.asset_code"/>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>
                                            
                                            <!-- Empty cell jika tidak ada label di slot ini -->
                                            <t t-else="">
                                                <div style="width:100%; height:100%;"></div>
                                            </t>
                                        </td>
                                    </t>
                                </tr>
                            </t>
                        </table>
                    </div>
                    
                    <!-- Page break jika bukan halaman terakhir -->
                    <t t-if="page_num &lt; total_pages - 1">
                        <div style="page-break-after: always;"></div>
                    </t>
                </t>
            </t>
        </template>

        <template id="report_asset_label_custom_109">
            <t t-call="web.basic_layout">
                <!-- Ambil qty dari context -->
                <t t-set="qty" t-value="int(context.get('custom_quantity', 1))"/>
                <t t-set="total_labels" t-value="qty * len(docs)"/>
                <t t-set="labels_per_page" t-value="40"/>  <!-- 5 x 8 = 40 -->
                <t t-set="total_pages" t-value="int((total_labels - 1) / labels_per_page) + 1 if total_labels > 0 else 1"/>
                
                <!-- Loop untuk setiap halaman -->
                <t t-foreach="range(total_pages)" t-as="page_num">
                    <div class="page">
                        <!-- Container utama dengan table layout untuk grid 5x8 (13x38mm per label) -->
                        <table style="width:190mm; height:104mm; margin:0; padding:0; border-collapse:collapse; table-layout:fixed; border:none;">
                            <!-- Hitung label untuk halaman ini -->
                            <t t-set="start_label" t-value="page_num * labels_per_page"/>
                            <t t-set="end_label" t-value="min((page_num + 1) * labels_per_page, total_labels)"/>
                            
                            <!-- Loop untuk 8 baris -->
                            <t t-foreach="range(8)" t-as="row">
                                <tr style="height:13mm; border:none;">
                                    <!-- Loop untuk 5 kolom -->
                                    <t t-foreach="range(5)" t-as="col">
                                        <t t-set="current_label" t-value="start_label + (row * 5 + col)"/>
                                        
                                        <td style="width:38mm; height:13mm; padding:0; margin:0; border:none; vertical-align:middle;">
                                            <!-- Jika masih ada label yang perlu dicetak di halaman ini -->
                                            <t t-if="current_label &lt; end_label">
                                                <!-- Tentukan asset untuk label ini -->
                                                <t t-set="asset_index" t-value="int(current_label / qty)"/>
                                                <t t-set="current_asset" t-value="docs[asset_index]"/>
                                                
                                                <div style="width:100%; height:100%; display:flex; flex-direction:column; justify-content:space-between; font-family:Arial, sans-serif; font-size:6px; padding:0.5mm; box-sizing:border-box;">
                                                    <!-- Company Name di atas -->
                                                    <div style="width:100%; text-align:center; flex-shrink:0; margin-bottom:1mm;">
                                                        <div style="font-weight:bold; font-size:6px; line-height:1;">
                                                            <t t-esc="current_asset.company_id.name"/>
                                                        </div>
                                                    </div>

                                                    <!-- Barcode di tengah -->
                                                    <div style="width:100%; text-align:center; flex-grow:1; display:flex; align-items:center; justify-content:center;">
                                                        <t t-set="barcode_value" t-value="current_asset.asset_code"/>
                                                        <t t-if="barcode_value">
                                                            <div t-out="barcode_value" t-options="{
                                                                'widget': 'barcode',
                                                                'symbology': 'Code128',
                                                                'width': 100, 
                                                                'height': 25, 
                                                                'quiet': 0,
                                                                'style': 'max-width:34mm; height:4mm; margin: 0 auto;'
                                                            }"/>
                                                        </t>
                                                    </div>

                                                    <!-- Asset Name & Code di bawah -->
                                                    <div style="width:100%; text-align:center; flex-shrink:0; margin-top:1mm;">
                                                        <div style="font-size:5px; font-weight:normal; line-height:1; word-wrap:break-word; overflow:hidden;">
                                                            <span t-esc="current_asset.name"/> - <strong t-esc="current_asset.asset_code"/>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>
                                            
                                            <!-- Empty cell jika tidak ada label di slot ini -->
                                            <t t-else="">
                                                <div style="width:100%; height:100%;"></div>
                                            </t>
                                        </td>
                                    </t>
                                </tr>
                            </t>
                        </table>
                    </div>
                    
                    <!-- Page break jika bukan halaman terakhir -->
                    <t t-if="page_num &lt; total_pages - 1">
                        <div style="page-break-after: always;"></div>
                    </t>
                </t>
            </t>
        </template>
    </data>
</odoo>